{"version":3,"sources":["../../shared/ng-cast.service.ts","../../dto/schedule-dto.ts","../../ng-cast.component.ts","../../ng.cast.module.ts","../../cast-videos.js"],"names":["NgCastService","_this","this","window","status","casting","onInitSuccess","console","log","onError","err","discoverDevices","self","subj","Subject","cast","requestSession","s","session","setCasting","next","code","undefined","error","onMediaDiscovered","categories","script","createElement","setAttribute","body","appendChild","globalThis","CastPlayer","mediaJSON","addMediaContents","play","currentMedia","pause","stop","onMediaError","prototype","initializeCastApi","sessionRequest","SessionRequest","apiConfig","ApiConfig","ReceiverAvailability","AVAILABLE","initialize","mediaContents","initializeUI","setupLocalPlayer","initializeCastPlayer","value","setupRemotePlayer","getStatus","Injectable","ScheduleDto","data","property","hasOwnProperty","fromJS","result","init","id","tenant","name","description","url","duration","actualStart","realEnd","isActive","toJSON","NgCastComponent","ngCastService","videoImage","imageOffline","premium","srcImageOffline","currentStream","type","label","source","api","VgAPI","isDebug","paused","streams","playlist","isHidden","isShow","currentIndex","video","appBaseUrl","ngOnInit","isAvailable","castingStatus","onPlayerReady","getDefaultMedia","subscriptions","ended","subscribe","nextVideo","bind","setBitrate","option","vgDash","length","getPaused","media","nativeElement","setTimeout","openSession","closeSession","tryAgain","getVideos","getPosition","vid","document","getElementById","load","now","Date","currentTime","Math","abs","getTime","promise","then","_","catch","getMuted","muted","getMaximized","fsAPI","isFullscreen","toggleSound","toggleMaximize","toggleFullscreen","showVideoControls","hideVideoControls","Component","args","selector","template","ViewChild","VgDASH","static","Input","NgModule","schemas","CUSTOM_ELEMENTS_SCHEMA","imports","CommonModule","VgCoreModule","VgControlsModule","VgStreamingModule","VgBufferingModule","VgOverlayPlayModule","exports","providers","declarations","PROGRESS_BAR_WIDTH","FULL_VOLUME_HEIGHT","PLAYER_STATE","playerHandler","PlayerHandler","playerState","playerStateBeforeSwitch","remotePlayer","remotePlayerController","currentMediaTime","mediaDuration","timer","incrementMediaTimeHandler","incrementMediaTime","seekMediaListener","seekMedia","currentMediaIndex","fullscreen","mediaInfo","whenSkippable","liveSeekableRange","isLiveContent","options","receiverApplicationId","autoJoinPolicy","chrome","AutoJoinPolicy","ORIGIN_SCOPED","framework","CastContext","getInstance","setOptions","castPlayer","RemotePlayer","RemotePlayerController","addEventListener","RemotePlayerEventType","IS_CONNECTED_CHANGED","switchPlayer","stopProgressTimer","resetVolumeSlider","isConnected","target","setTarget","style","display","updateDisplayMessage","mediaIndex","isMediaLoaded","prepareToPlay","getMediaDuration","updateDurationDisplay","startProgressTimer","updateDisplay","loaded","currentMediaDuration","updateMediaDuration","seekTo","getCurrentMediaTime","updateCurrentTimeDisplay","setTimeString","element","time","setVolume","volumeSliderPosition","mute","unMute","isMuted","localPlayer","onMediaLoadedLocally","playerTarget","src","volume","p","height","marginTop","DEFAULT_VOLUME","showFullscreenButton","castSession","getCurrentSession","IS_PAUSED_CHANGED","isPaused","IS_MUTED_CHANGED","VOLUME_LEVEL_CHANGED","newVolume","volumeLevel","playOrPause","MediaInfo","metadata","GenericMediaMetadata","metadataType","MetadataType","GENERIC","title","images","request","LoadRequest","loadMedia","errorCode","getErrorMessage","innerHTML","getCastDevice","friendlyName","currentVolume","vScale","pos","setVolumeLevel","muteOrUnmute","seek","hideFullscreenButton","selectMedia","currentMediaInfo","marginLeft","width","seekable_window","unseekable_overlay","event","canSeek","position","parseInt","offsetX","pi","progress","seekTime","pp","pw","currentTarget","sectionStartTimeInMedia","mouseEvent","offsetY","clientHeight","setInterval","clearInterval","updateProgressBarByTimer","endPlayback","isNaN","floor","getMediaTimeString","timestamp","isNegative","hours","minutes","seconds","getClockTimeString","date","getHours","getMinutes","getSeconds","ampm","slice","updateAdMarkers","getMediaSession","breaks","contentDuration","i","adBreak","isEmbedded","adPositionToMargin","removeAdMarkers","querySelectorAll","forEach","adMarker","remove","onBreakClipIdChanged","skip","isPlayingBreak","enableProgressBar","onWhenSkippableChanged","onCurrentBreakClipTimeChanged","currentBreakClipTime","skipAd","enable","progress_indicator","backgroundImage","cursor","draggable","removeEventListener","getDurationString","durationInSec","durationString","durationInMin","durationInHour","requestFullScreen","requestMethod","call","cancelFullScreen","fullscreenChangeHandler","fullscreen_expand","fullscreen_collapse","showMediaControl","media_control","opacity","hideMediaControl","context","showVolumeSlider","hideVolumeSlider","defaultVolumeSliderHeight","addVideoThumbs","ni","newdiv","divIdName","ErrorCode","API_NOT_INITIALIZED","CANCEL","CHANNEL_ERROR","EXTENSION_MISSING","INVALID_PARAMETER","RECEIVER_UNAVAILABLE","SESSION_ERROR","TIMEOUT"],"mappings":"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","sourcesContent":["import { Injectable } from '@angular/core';\n\nimport { Subject } from 'rxjs';\n\ndeclare global {\n  var CastPlayer: any;\n}\n\n@Injectable()\nexport class NgCastService {\n  private cast: any;\n  private currentMedia: any;\n  private window: any = window;\n\n  public status = {\n    casting: false\n  };\n\n  constructor() {\n    globalThis.CastPlayer.mediaJSON = {\n      categories: []\n    };\n  }\n\n  initializeCastApi() {\n    this.cast = this.window['chrome'].cast;\n    let sessionRequest = new this.cast.SessionRequest('4F8B3483');\n    let apiConfig = new this.cast.ApiConfig(sessionRequest,\n      () => { },\n      (status: any) => { if (status === this.cast.ReceiverAvailability.AVAILABLE) { } }\n    );\n    let x = this.cast.initialize(apiConfig, this.onInitSuccess, this.onError);\n  };\n\n  onInitSuccess = function () {\n    console.log('GCast initialization success');\n  };\n\n  onError = function (err: any) {\n    console.log('GCast initialization failed', err);\n  };\n\n  discoverDevices = () => {\n    let self: any = this;\n    let subj = new Subject();\n    this.cast.requestSession((s: any) => {\n      self.session = s;\n      self.setCasting(true);\n      subj.next('CONNECTED');\n    }, function (err: any) {\n      self.setCasting(false);\n      if (err.code === 'cancel') {\n        self.session = undefined;\n        subj.next('CANCEL');\n      } else {\n        console.error('Error selecting a cast device', err);\n      }\n    });\n    return subj;\n  };\n\n  onMediaDiscovered = (categories: any[]) => {\n    let script = window['document'].createElement('script');\n    script.setAttribute('type', 'text/javascript');\n    script.setAttribute('src', 'https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1');\n    window['document'].body.appendChild(script);\n\n    globalThis.CastPlayer.mediaJSON.categories = categories;\n\n    return globalThis.CastPlayer.addMediaContents();\n  };\n\n  initialize(mediaContents: any): void {\n    if (mediaContents) {\n      globalThis.CastPlayer.initializeUI();\n      globalThis.CastPlayer.setupLocalPlayer();\n      globalThis.CastPlayer.initializeCastPlayer();\n    }\n  }\n\n  play = () => {\n    this.currentMedia.play(null);\n  };\n\n  pause = () => {\n    this.currentMedia.pause(null);\n  };\n\n  stop = () => {\n    this.currentMedia.stop(null);\n  };\n\n  onMediaError = (err: any) => {\n    console.error('Error launching media', err);\n  };\n\n  setCasting(value: any) {\n    this.status.casting = value;\n    globalThis.CastPlayer.setupRemotePlayer();\n  }\n\n  getStatus() {\n    return this.status\n  }\n}\n","import { TenantDto } from './tenant-dto';\n\nexport interface IScheduleDto {\n    id: string | undefined;\n    tenant: TenantDto | undefined;\n    name: string | undefined;\n    description: string | undefined;\n    url: string | undefined;\n    duration: number | undefined;\n    actualStart: Date;\n    realEnd?: Date | undefined;\n    isActive: boolean | undefined;\n}\n\nexport class ScheduleDto implements IScheduleDto {\n    id: string | undefined;\n    tenant: TenantDto | undefined;\n    name: string | undefined;\n    description: string | undefined;\n    url: string | undefined;\n    duration: number | undefined;\n    actualStart!: Date;\n    realEnd?: Date | undefined;\n    isActive: boolean | undefined;\n\n    constructor(data?: IScheduleDto) {\n        if (data) {\n            for (let property in data) {\n                if (data.hasOwnProperty(property)) {\n                    (<any>this)[property] = (<any>data)[property];\n                }\n            }\n        }\n    }\n\n    static fromJS(data: any): ScheduleDto {\n        data = typeof data === 'object' ? data : {};\n        let result = new ScheduleDto();\n        result.init(data);\n        return result;\n    }\n\n    init(data?: any) {\n        if (data) {\n            this.id = data['id'];\n            this.tenant = data['tenant'];\n            this.name = data['name'];\n            this.description = data['description'];\n            this.url = data['url'];\n            this.duration = data['duration'];\n            this.actualStart = data['actualStart'];\n            this.realEnd = data['realEnd'];\n            this.isActive = data['isActive'];\n        }\n    }\n\n    toJSON(data?: any) {\n        data = typeof data === 'object' ? data : {};\n        data['id'] = this.id;\n        data['tenant'] = this.tenant;\n        data['name'] = this.name;\n        data['description'] = this.description;\n        data['url'] = this.url;\n        data['duration'] = this.duration;\n        data['actualStart'] = this.actualStart;\n        data['realEnd'] = this.realEnd;\n        data['isActive'] = this.isActive;\n        return data;\n    }\n}\n","import { Component, Input, OnInit, ViewChild, ElementRef } from '@angular/core';\n\nimport { NgCastService } from './shared/ng-cast.service';\n\nimport { VgDASH } from 'videogular2/compiled/src/streaming/vg-dash/vg-dash';\nimport { IDRMLicenseServer } from 'videogular2/compiled/src/streaming/streaming';\nimport { VgAPI, BitrateOption } from 'videogular2/compiled/core';\n\nimport { ScheduleDto } from './dto/schedule-dto';\n\nexport interface IMediaStream {\n  type: 'vod' | 'dash';\n  source: string;\n  label: string;\n  token?: string;\n  licenseServers?: IDRMLicenseServer;\n}\n\n@Component({\n  selector: 'ng-cast',\n  templateUrl: './ng-cast.component.html',\n  styleUrls: [\n    './ng-cast.component.scss'\n  ]\n})\nexport class NgCastComponent implements OnInit {\n  @ViewChild(VgDASH, { static: false }) vgDash!: VgDASH;\n  @ViewChild('media', { static: false }) media!: ElementRef<HTMLVideoElement>;\n\n  castingStatus: any;\n  window: any;\n\n  @Input() videoImage = '';\n  @Input() imageOffline = false;\n  @Input() premium = false;\n  @Input() srcImageOffline = '';\n\n  @Input() currentStream: IMediaStream = {\n    type: 'dash',\n    label: 'DASH: Media Stream test',\n    source: 'http://livesim.dashif.org/livesim/testpic_2s/Manifest.mpd'\n  };\n\n  api: VgAPI = new VgAPI();\n\n  @Input() isDebug = false;\n\n  @Input() paused = false;\n\n  @Input() streams: IMediaStream[] = [\n    {\n      type: 'dash',\n      label: 'DASH: Media Stream test',\n      source: 'http://livesim.dashif.org/livesim/testpic_2s/Manifest.mpd'\n    }\n  ];\n\n  @Input() playlist: Array<ScheduleDto> = [];\n\n  @Input() play = false;\n  @Input() isHidden = false;\n  @Input() isShow = true;\n\n  @Input() currentIndex = 0;\n  @Input() video: ScheduleDto = new ScheduleDto();\n  @Input() appBaseUrl: String = '';\n\n  constructor(\n    private ngCastService: NgCastService\n  ) { }\n\n  ngOnInit() {\n    this.window = window;\n    this.currentStream = this.streams[0];\n\n    let ngCastService = this.ngCastService;\n    this.window['__onGCastApiAvailable'] = function (isAvailable: boolean) {\n      if (isAvailable) {\n        ngCastService.initializeCastApi();\n      }\n    };\n\n    this.castingStatus = this.ngCastService.getStatus();\n  }\n\n  onPlayerReady(api: VgAPI) {\n    this.api = api;\n\n    this.api.getDefaultMedia().subscriptions.ended.subscribe(this.nextVideo.bind(this));\n  }\n\n  setBitrate(option: BitrateOption) {\n    switch (this.currentStream.type) {\n      case 'dash':\n        this.vgDash.setBitrate(option);\n        break;\n    }\n  }\n\n  nextVideo() {\n    this.currentIndex++;\n\n    if (this.currentIndex === this.playlist.length) {\n      this.currentIndex = 0;\n    }\n\n    this.video = this.playlist[this.currentIndex];\n  }\n\n  getPaused() {\n    if (this.media && this.media.nativeElement) {\n      this.paused = this.media.nativeElement.paused;\n      return this.media.nativeElement.paused;\n    } else {\n      setTimeout(() => {\n        return this.getPaused();\n      }, 2000);\n    }\n  }\n\n  pause(): void {\n    this.media.nativeElement.pause();\n    this.getPaused();\n  }\n\n  openSession() {\n    this.ngCastService.discoverDevices();\n  }\n\n  closeSession() {\n    this.ngCastService.discoverDevices();\n  }\n\n  tryAgain() {\n    this.imageOffline = true;\n    this.isHidden = true;\n    console.log('loading...');\n\n    setTimeout(() => {\n      this.getVideos();\n    }, 500);\n  }\n\n  getVideos(): void {\n    if (this.playlist && this.playlist.length > 0) {\n      this.imageOffline = false;\n      this.video = this.playlist[this.currentIndex];\n\n      this.getPosition(this.video);\n    } else {\n      this.video = new ScheduleDto();\n      this.tryAgain();\n    }\n  }\n\n  getPosition(result: ScheduleDto) {\n    setTimeout(() => {\n      let vid: any = document.getElementById('video_element');\n      vid.load();\n\n      const now = new Date();\n      const currentTime = Math.abs(now.getTime() - new Date(this.video.actualStart).getTime());\n\n      console.log('Temos no player: ' + result.url);\n      console.log('Início em: ' + currentTime);\n\n      this.video.url = result.url;\n      vid['currentTime'] = currentTime / 1000;\n\n      let promise = vid.play();\n      if (promise !== undefined) {\n        promise.then((_: any) => {\n          // Autoplay started!\n          console.log('Estamos ao vivo!');\n        }).catch(() => {\n          // Autoplay was prevented.\n          // Show a \"Play\" button so that user can start playback.\n          this.play = true;\n        });\n      }\n    }, 1000);\n  }\n\n  getMuted(): boolean {\n    return this.media && this.media.nativeElement && this.media.nativeElement.muted || false;\n  }\n\n  getMaximized(): boolean {\n    return this.api && this.api.fsAPI && this.api.fsAPI.isFullscreen && this.api.fsAPI.isFullscreen || false;\n  }\n\n  toggleSound(): void {\n    this.media.nativeElement.muted = !this.media.nativeElement.muted;\n  }\n\n  toggleMaximize(): void {\n    this.api.fsAPI.toggleFullscreen(this.media);\n  }\n\n  showVideoControls(): void {\n    this.isHidden = false;\n    this.isShow = true;\n  }\n\n  hideVideoControls(): void {\n    this.isHidden = true;\n    this.isShow = false;\n  }\n}\n","import { CUSTOM_ELEMENTS_SCHEMA, NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { NgCastComponent } from './ng-cast.component';\nimport { NgCastService } from './shared/ng-cast.service';\n\nimport { VgCoreModule } from 'videogular2/compiled/core';\nimport { VgControlsModule } from 'videogular2/compiled/controls';\nimport { VgStreamingModule } from 'videogular2/compiled/streaming';\nimport { VgBufferingModule } from 'videogular2/compiled/buffering';\nimport { VgOverlayPlayModule } from 'videogular2/compiled/overlay-play';\n\n@NgModule({\n  schemas: [ CUSTOM_ELEMENTS_SCHEMA ],\n  imports: [\n    CommonModule,\n    VgCoreModule,\n    VgControlsModule,\n    VgStreamingModule,\n    VgBufferingModule,\n    VgOverlayPlayModule,\n  ],\n  exports: [NgCastComponent],\n  providers: [NgCastService],\n  declarations: [NgCastComponent]\n})\nexport class NgCastModule { }\n","\"use strict\";\n\n/** @const {string} Media source root URL */\nconst MEDIA_SOURCE_ROOT = '';\n\n/**\n * Width of progress bar in pixel\n * @const\n */\nvar PROGRESS_BAR_WIDTH = 600;\n\n/** @const {number} Time in milliseconds for minimal progress update */\nvar TIMER_STEP = 1000;\n\n/** @const {number} Cast volume upon initial connection */\nvar DEFAULT_VOLUME = 0.5;\n\n/** @const {number} Height, in pixels, of volume bar */\nvar FULL_VOLUME_HEIGHT = 100;\n\n/** @enum {string} Constants of states for media for both local and remote playback */\nconst PLAYER_STATE = {\n  // No media is loaded into the player. For remote playback, maps to\n  // the PlayerState.IDLE state.\n  IDLE: 'IDLE',\n  LOADING: 'LOADING',\n  // Player is in PLAY mode but not actively playing content. For remote\n  // playback, maps to the PlayerState.BUFFERING state.\n  BUFFERING: 'BUFFERING',\n  // The media is loaded but not playing.\n  LOADED: 'LOADED',\n  // The media is playing. For remote playback, maps to the PlayerState.PLAYING state.\n  PLAYING: 'PLAYING',\n  // The media is paused. For remote playback, maps to the PlayerState.PAUSED state.\n  PAUSED: 'PAUSED',\n  STOPPED: 'STOPPED',\n  ERROR: 'ERROR'\n};\n\n/**\n * Cast player object\n * Main variables:\n *  - PlayerHandler object for handling media playback\n *  - Cast player variables for controlling Cast mode media playback\n *  - Current media variables for transition between Cast and local modes\n *  - Current ad variables for controlling UI based on ad playback\n *  - Current live variables for controlling UI based on ad playback\n * @struct @constructor\n */\nvar CastPlayer = function () {\n  /** @type {PlayerHandler} Delegation proxy for media playback */\n  this.playerHandler = new PlayerHandler(this);\n\n  /** @type {PLAYER_STATE} A state for media playback */\n  this.playerState = PLAYER_STATE.IDLE;\n\n  /**\n   * @type {PLAYER_STATE} Player state before switching between local and\n   * remote playback.\n   */\n  this.playerStateBeforeSwitch = null;\n\n  /* Cast player variables */\n  /** @type {cast.framework.RemotePlayer} */\n  this.remotePlayer = null;\n  /** @type {cast.framework.RemotePlayerController} */\n  this.remotePlayerController = null;\n\n  /* Local+Remote player variables */\n  /** @type {number} A number for current time in seconds. Maintained in media time. */\n  this.currentMediaTime = 0;\n  /**\n   * @type {?number} A number for current duration in seconds. Maintained in media time.\n   * Null if duration should not be shown.\n   */\n  this.mediaDuration = -1;\n\n  /** @type {?number} A timer for tracking progress of media */\n  this.timer = null;\n  /** @type {function()} Listener for handling current time increments */\n  this.incrementMediaTimeHandler = this.incrementMediaTime.bind(this);\n  /** @type {function()} Listener to be added/removed for the seek action */\n  this.seekMediaListener = this.seekMedia.bind(this);\n\n  /* Local player variables */\n  /** @type {number} A number for current media index */\n  this.currentMediaIndex = 0;\n  /** @type {?Object} media contents from JSON */\n  this.mediaContents = null;\n  /** @type {boolean} Fullscreen mode on/off */\n  this.fullscreen = false;\n\n  /* Remote Player variables */\n  /** @type {?chrome.cast.media.MediaInfo} Current mediaInfo */\n  this.mediaInfo = null;\n  /* Ad variables */\n  /**\n   * @type {?number} The time in seconds when the break clip becomes skippable.\n   * 5 means that the end user can skip this break clip after 5 seconds. If\n   * negative or not defined, it means that the current break clip is not skippable.\n   */\n  this.whenSkippable = null;\n\n  /* Live variables */\n  /** @type {?chrome.cast.media.LiveSeekableRange} Seekable range for live content */\n  this.liveSeekableRange = null;\n  /** @type {boolean} Remote player is playing live content. */\n  this.isLiveContent = false;\n\n  this.mediaJSON = {\n    'categories': []\n  };\n};\n\nCastPlayer.prototype.initializeCastPlayer = () => {\n  var options = {};\n\n  // Set the receiver application ID to your own (created in the\n  // Google Cast Developer Console), or optionally\n  // use the chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID\n  options.receiverApplicationId = '4F8B3483';\n\n  // Auto join policy can be one of the following three:\n  // ORIGIN_SCOPED - Auto connect from same appId and page origin\n  // TAB_AND_ORIGIN_SCOPED - Auto connect from same appId, page origin, and tab\n  // PAGE_SCOPED - No auto connect\n  options.autoJoinPolicy = chrome.cast.AutoJoinPolicy.ORIGIN_SCOPED;\n\n  cast.framework.CastContext.getInstance().setOptions(options);\n\n  castPlayer.remotePlayer = new cast.framework.RemotePlayer();\n  castPlayer.remotePlayerController = new cast.framework.RemotePlayerController(castPlayer.remotePlayer);\n  castPlayer.remotePlayerController.addEventListener(\n      cast.framework.RemotePlayerEventType.IS_CONNECTED_CHANGED,\n      castPlayer.switchPlayer.bind(castPlayer)\n  );\n};\n\n/**\n * Switch between the remote and local players.\n */\nCastPlayer.prototype.switchPlayer = () => {\n  castPlayer.stopProgressTimer();\n  castPlayer.resetVolumeSlider();\n  castPlayer.playerHandler.stop();\n  castPlayer.playerState = PLAYER_STATE.IDLE;\n  if (cast && cast.framework) {\n      if (castPlayer.remotePlayer.isConnected) {\n        castPlayer.setupRemotePlayer();\n          return;\n      }\n  }\n  castPlayer.setupLocalPlayer();\n};\n\n/**\n * PlayerHandler\n *\n * This is a handler through which the application will interact\n * with both the RemotePlayer and LocalPlayer. Combining these two into\n * one interface is one approach to the dual-player nature of a Cast\n * Chrome application. Otherwise, the state of the RemotePlayer can be\n * queried at any time to decide whether to interact with the local\n * or remote players.\n *\n * To set the player used, implement the following methods for a target object\n * and call setTarget(target).\n *\n * Methods to implement:\n *  - play()\n *  - pause()\n *  - stop()\n *  - seekTo(time)\n *  - load(mediaIndex)\n *  - isMediaLoaded(mediaIndex)\n *  - prepareToPlay()\n *  - getMediaDuration()\n *  - getCurrentMediaTime()\n *  - setVolume(volumeSliderPosition)\n *  - mute()\n *  - unMute()\n *  - isMuted()\n *  - updateDisplay()\n *  - updateCurrentTimeDisplay()\n *  - updateDurationDisplay()\n *  - setTimeString(element, time)\n */\nvar PlayerHandler = function (castPlayer) {\n  this.target = {};\n\n  this.setTarget = function (target) {\n    this.target = target;\n  };\n\n  this.play = function () {\n    if (castPlayer.playerState !== PLAYER_STATE.PLAYING &&\n      castPlayer.playerState !== PLAYER_STATE.PAUSED &&\n      castPlayer.playerState !== PLAYER_STATE.LOADED) {\n      this.load(castPlayer.currentMediaIndex);\n      return;\n    }\n\n    this.target.play();\n    castPlayer.playerState = PLAYER_STATE.PLAYING;\n    document.getElementById('play').style.display = 'none';\n    document.getElementById('pause').style.display = 'block';\n    this.updateDisplayMessage();\n  };\n\n  this.updateDisplayMessage = function () {\n    this.target.updateDisplayMessage();\n  }\n\n  this.pause = function () {\n    this.target.pause();\n    castPlayer.playerState = PLAYER_STATE.PAUSED;\n    document.getElementById('play').style.display = 'block';\n    document.getElementById('pause').style.display = 'none';\n  };\n\n  this.stop = function () {\n    castPlayer.playerState = PLAYER_STATE.IDLE;\n    this.target.stop();\n  };\n\n  this.load = function (mediaIndex = null) {\n    if (!mediaIndex) {\n      mediaIndex = castPlayer.currentMediaIndex;\n    }\n    castPlayer.playerState = PLAYER_STATE.BUFFERING;\n    this.target.load(mediaIndex);\n  };\n\n  /**\n   * Check if media has been loaded on the target player.\n   * @param {number?} mediaIndex The desired media index. If null, verify if\n   *  any media is loaded.\n   */\n  this.isMediaLoaded = function (mediaIndex) {\n    return this.target.isMediaLoaded(mediaIndex);\n  };\n\n  /**\n   * Called after media has been successfully loaded and is ready to start playback.\n   * When local, will start playing the video, start the timer, and update the UI.\n   * When remote, will set the UI to PLAYING and start the timer to update the\n   *   UI based on remote playback.\n   */\n  this.prepareToPlay = function () {\n    castPlayer.mediaDuration = this.getMediaDuration();\n    castPlayer.playerHandler.updateDurationDisplay();\n    castPlayer.playerState = PLAYER_STATE.LOADED;\n\n    this.play();\n    castPlayer.startProgressTimer();\n    this.updateDisplay();\n  };\n\n  this.loaded = function() {\n    castPlayer.currentMediaDuration = this.getMediaDuration();\n    castPlayer.updateMediaDuration();\n    castPlayer.playerState = PLAYER_STATE.LOADED;\n    if (castPlayer.currentMediaTime > 0) {\n        this.seekTo(castPlayer.currentMediaTime);\n    }\n    this.play();\n    castPlayer.startProgressTimer();\n    this.updateDisplayMessage();\n  };\n\n  this.getCurrentMediaTime = function () {\n    return this.target.getCurrentMediaTime();\n  };\n\n  this.getMediaDuration = function () {\n    return this.target.getMediaDuration();\n  };\n\n  this.updateDisplay = function () {\n    // Update local variables\n    this.currentMediaTime = this.target.getCurrentMediaTime();\n    this.mediaDuration = this.target.getMediaDuration();\n\n    this.target.updateDisplay();\n  };\n\n  this.updateCurrentTimeDisplay = function () {\n    this.target.updateCurrentTimeDisplay();\n  };\n\n  /**\n   * Determines the correct time string (media or clock) and sets it for the given element.\n   */\n  this.setTimeString = function (element, time) {\n    this.target.setTimeString(element, time);\n  };\n\n  this.setVolume = function (volumeSliderPosition) {\n    this.target.setVolume(volumeSliderPosition);\n  };\n\n  this.mute = function () {\n    this.target.mute();\n    document.getElementById('audio_on').style.display = 'none';\n    document.getElementById('audio_off').style.display = 'block';\n  };\n\n  this.unMute = function () {\n    this.target.unMute();\n    document.getElementById('audio_on').style.display = 'block';\n    document.getElementById('audio_off').style.display = 'none';\n  };\n\n  this.isMuted = function () {\n    return this.target.isMuted();\n  };\n\n  this.seekTo = function (time) {\n    this.target.seekTo(time);\n  };\n};\n\n/**\n * Set the PlayerHandler target to use the video-element player\n */\nCastPlayer.prototype.setupLocalPlayer = () => {\n  var localPlayer = document.getElementById('video_element');\n  localPlayer.addEventListener(\n    'loadeddata', castPlayer.onMediaLoadedLocally.bind(castPlayer));\n\n  // This object will implement PlayerHandler callbacks with localPlayer\n  var playerTarget = {};\n\n  playerTarget.play = () => {\n    localPlayer.play();\n\n    var vi = document.getElementById('video_image');\n    vi.style.display = 'none';\n    localPlayer.style.display = 'block';\n  };\n\n  playerTarget.pause = function () {\n    localPlayer.pause();\n  };\n\n  playerTarget.stop = function () {\n    if (typeof localPlayer.stop === \"function\")\n      localPlayer.stop();\n  };\n\n  playerTarget.load = function (mediaIndex) {\n    localPlayer.src =\n      castPlayer.mediaContents[mediaIndex]['sources'][0];\n    localPlayer.load();\n  }.bind(castPlayer);\n\n  playerTarget.getCurrentMediaTime = function () {\n    return localPlayer.currentTime;\n  };\n\n  playerTarget.getMediaDuration = function () {\n    return localPlayer.duration;\n  };\n\n  playerTarget.updateDisplayMessage = function () {\n    document.getElementById('playerstate').style.display = 'none';\n    document.getElementById('playerstatebg').style.display = 'none';\n    document.getElementById('video_image_overlay').style.display = 'none';\n  };\n\n  playerTarget.setVolume = function (volumeSliderPosition) {\n    localPlayer.volume = volumeSliderPosition < FULL_VOLUME_HEIGHT ?\n      volumeSliderPosition / FULL_VOLUME_HEIGHT : 1;\n    var p = document.getElementById('audio_bg_level');\n    p.style.height = volumeSliderPosition + 'px';\n    p.style.marginTop = -volumeSliderPosition + 'px';\n  };\n\n  playerTarget.mute = function () {\n    localPlayer.muted = true;\n  };\n\n  playerTarget.unMute = function () {\n    localPlayer.muted = false;\n  };\n\n  playerTarget.isMuted = function () {\n    return localPlayer.muted;\n  };\n\n  playerTarget.seekTo = function (time) {\n    localPlayer.currentTime = time;\n  };\n\n  castPlayer.playerHandler.setTarget(playerTarget);\n\n  castPlayer.playerHandler.setVolume(DEFAULT_VOLUME * FULL_VOLUME_HEIGHT);\n\n  castPlayer.showFullscreenButton();\n\n  if (castPlayer.currentMediaTime > 0) {\n    castPlayer.playerHandler.play();\n  }\n};\n\n/**\n * Set the PlayerHandler target to use the remote player\n * Add event listeners for player changes which may occur outside sender app.\n */\nCastPlayer.prototype.setupRemotePlayer = function () {\n  var castSession = cast.framework.CastContext.getInstance().getCurrentSession();\n\n  // Add event listeners for player changes which may occur outside sender app\n  castPlayer.remotePlayerController.addEventListener(\n      cast.framework.RemotePlayerEventType.IS_PAUSED_CHANGED,\n      function() {\n          if (castPlayer.remotePlayer.isPaused) {\n              castPlayer.playerHandler.pause();\n          } else {\n              castPlayer.playerHandler.play();\n          }\n      }.bind(castPlayer)\n  );\n\n  castPlayer.remotePlayerController.addEventListener(\n      cast.framework.RemotePlayerEventType.IS_MUTED_CHANGED,\n      function() {\n          if (castPlayer.remotePlayer.isMuted) {\n              castPlayer.playerHandler.mute();\n          } else {\n              castPlayer.playerHandler.unMute();\n          }\n      }.bind(castPlayer)\n  );\n\n  castPlayer.remotePlayerController.addEventListener(\n      cast.framework.RemotePlayerEventType.VOLUME_LEVEL_CHANGED,\n      function() {\n          var newVolume = castPlayer.remotePlayer.volumeLevel * FULL_VOLUME_HEIGHT;\n          var p = document.getElementById('audio_bg_level');\n          p.style.height = newVolume + 'px';\n          p.style.marginTop = -newVolume + 'px';\n      }.bind(castPlayer)\n  );\n\n  // castPlayer object will implement PlayerHandler callbacks with\n  // remotePlayerController, and makes necessary UI updates specific\n  // to remote playback\n  var playerTarget = {};\n\n  playerTarget.play = function () {\n      if (castPlayer.remotePlayer.isPaused) {\n          castPlayer.remotePlayerController.playOrPause();\n      }\n\n      var vi = document.getElementById('video_image');\n      vi.style.display = 'block';\n      var localPlayer = document.getElementById('video_element');\n      localPlayer.style.display = 'none';\n  }.bind(castPlayer);\n\n  playerTarget.pause = function () {\n      if (!castPlayer.remotePlayer.isPaused) {\n          castPlayer.remotePlayerController.playOrPause();\n      }\n  }.bind(castPlayer);\n\n  playerTarget.stop = function () {\n       castPlayer.remotePlayerController.stop();\n  }.bind(castPlayer);\n\n  playerTarget.load = function (mediaIndex) {\n      console.log('Loading...' + castPlayer.mediaContents[mediaIndex]['title']);\n      var mediaInfo = new chrome.cast.media.MediaInfo(\n          castPlayer.mediaContents[mediaIndex]['sources'][0], 'video/mp4');\n\n      mediaInfo.metadata = new chrome.cast.media.GenericMediaMetadata();\n      mediaInfo.metadata.metadataType = chrome.cast.media.MetadataType.GENERIC;\n      mediaInfo.metadata.title = castPlayer.mediaContents[mediaIndex]['title'];\n      mediaInfo.metadata.images = [\n          {'url': MEDIA_SOURCE_ROOT + castPlayer.mediaContents[mediaIndex]['thumb']}];\n\n      var request = new chrome.cast.media.LoadRequest(mediaInfo);\n      castSession.loadMedia(request).then(\n          castPlayer.playerHandler.loaded.bind(castPlayer.playerHandler),\n          function (errorCode) {\n              castPlayer.playerState = PLAYER_STATE.ERROR;\n              console.log('Remote media load error: ' +\n                  CastPlayer.getErrorMessage(errorCode));\n          }.bind(castPlayer));\n  }.bind(castPlayer);\n\n  playerTarget.getCurrentMediaTime = function() {\n      return castPlayer.remotePlayer.currentTime;\n  }.bind(castPlayer);\n\n  playerTarget.getMediaDuration = function() {\n      return castPlayer.remotePlayer.duration;\n  }.bind(castPlayer);\n\n  playerTarget.updateDisplayMessage = function () {\n      document.getElementById('playerstate').style.display = 'block';\n      document.getElementById('playerstatebg').style.display = 'block';\n      document.getElementById('video_image_overlay').style.display = 'block';\n      document.getElementById('playerstate').innerHTML =\n          castPlayer.mediaContents[ castPlayer.currentMediaIndex]['title'] + ' ' +\n          castPlayer.playerState + ' on ' + castSession.getCastDevice().friendlyName;\n  }.bind(castPlayer);\n\n  playerTarget.setVolume = function (volumeSliderPosition) {\n      // Add resistance to avoid loud volume\n      var currentVolume = castPlayer.remotePlayer.volumeLevel;\n      var p = document.getElementById('audio_bg_level');\n      if (volumeSliderPosition < FULL_VOLUME_HEIGHT) {\n          var vScale =  castPlayer.currentVolume * FULL_VOLUME_HEIGHT;\n          if (volumeSliderPosition > vScale) {\n              volumeSliderPosition = vScale + (pos - vScale) / 2;\n          }\n          p.style.height = volumeSliderPosition + 'px';\n          p.style.marginTop = -volumeSliderPosition + 'px';\n          currentVolume = volumeSliderPosition / FULL_VOLUME_HEIGHT;\n      } else {\n          currentVolume = 1;\n      }\n      castPlayer.remotePlayer.volumeLevel = currentVolume;\n      castPlayer.remotePlayerController.setVolumeLevel();\n  }.bind(castPlayer);\n\n  playerTarget.mute = function () {\n      if (!castPlayer.remotePlayer.isMuted) {\n          castPlayer.remotePlayerController.muteOrUnmute();\n      }\n  }.bind(castPlayer);\n\n  playerTarget.unMute = function () {\n      if (castPlayer.remotePlayer.isMuted) {\n          castPlayer.remotePlayerController.muteOrUnmute();\n      }\n  }.bind(castPlayer);\n\n  playerTarget.isMuted = function() {\n      return castPlayer.remotePlayer.isMuted;\n  }.bind(castPlayer);\n\n  playerTarget.seekTo = function (time) {\n      castPlayer.remotePlayer.currentTime = time;\n      castPlayer.remotePlayerController.seek();\n  }.bind(castPlayer);\n\n  castPlayer.playerHandler.setTarget(playerTarget);\n\n  // Setup remote player volume right on setup\n  // The remote player may have had a volume set from previous playback\n  if (castPlayer.remotePlayer.isMuted) {\n      castPlayer.playerHandler.mute();\n  }\n  var currentVolume = castPlayer.remotePlayer.volumeLevel * FULL_VOLUME_HEIGHT;\n  var p = document.getElementById('audio_bg_level');\n  p.style.height = currentVolume + 'px';\n  p.style.marginTop = -currentVolume + 'px';\n\n  castPlayer.hideFullscreenButton();\n\n  castPlayer.playerHandler.play();\n};\n\n/**\n * Callback when media is loaded in local player\n */\nCastPlayer.prototype.onMediaLoadedLocally = function () {\n  var localPlayer = document.getElementById('video_element');\n  localPlayer.currentTime = castPlayer.currentMediaTime;\n\n  castPlayer.playerHandler.loaded();\n};\n\n/**\n * Select a media content\n * @param {number} mediaIndex A number for media index\n */\nCastPlayer.prototype.selectMedia = function (mediaIndex) {\n  console.log('Media index selected: ' + mediaIndex);\n\n  castPlayer.currentMediaIndex = mediaIndex;\n  // Clear currentMediaInfo when playing content from the sender.\n  castPlayer.playerHandler.currentMediaInfo = undefined;\n\n  // Set video image\n  var vi = document.getElementById('video_image');\n  vi.src = MEDIA_SOURCE_ROOT + castPlayer.mediaContents[mediaIndex]['thumb'];\n\n  // Reset progress bar\n  var pi = document.getElementById('progress_indicator');\n  pi.style.marginLeft = '0px';\n  var progress = document.getElementById('progress');\n  progress.style.width = '0px';\n\n  let seekable_window = document.getElementById('seekable_window');\n  let unseekable_overlay = document.getElementById('unseekable_overlay');\n  seekable_window.style.width = PROGRESS_BAR_WIDTH;\n  unseekable_overlay.style.width = '0px';\n\n  // Stop timer and reset time displays\n  castPlayer.stopProgressTimer();\n  castPlayer.currentMediaTime = 0;\n  castPlayer.playerHandler.setTimeString(document.getElementById('currentTime'), 0);\n  castPlayer.playerHandler.setTimeString(document.getElementById('duration'), 0);\n\n  castPlayer.playerState = PLAYER_STATE.IDLE;\n  castPlayer.playerHandler.play();\n};\n\n/**\n * Media seek function\n * @param {Event} event An event object from seek\n */\nCastPlayer.prototype.seekMedia = function (event) {\n  if (castPlayer.mediaDuration == null || (cast.framework.CastContext.getInstance().getCurrentSession() && !castPlayer.remotePlayer.canSeek)) {\n    console.log('Error - Not seekable');\n    return;\n  }\n\n  if (castPlayer.isLiveContent && !castPlayer.liveSeekableRange) {\n    console.log('Live content has no seekable range.')\n    return;\n  }\n\n  var position = parseInt(event.offsetX, 10);\n  var pi = document.getElementById('progress_indicator');\n  var progress = document.getElementById('progress');\n  let seekTime = 0;\n  let pp = 0;\n  let pw = 0;\n  if (event.currentTarget.id == 'progress_indicator') {\n    seekTime = parseInt(castPlayer.currentMediaTime + castPlayer.mediaDuration * position /\n      PROGRESS_BAR_WIDTH, 10);\n    pp = parseInt(pi.style.marginLeft, 10) + position;\n    pw = parseInt(progress.style.width, 10) + position;\n  } else {\n    seekTime = parseInt(position * castPlayer.mediaDuration / PROGRESS_BAR_WIDTH, 10);\n    pp = position;\n    pw = position;\n  }\n\n  if (castPlayer.playerState === PLAYER_STATE.PLAYING ||\n    castPlayer.playerState === PLAYER_STATE.PAUSED) {\n    castPlayer.currentMediaTime = seekTime;\n    progress.style.width = pw + 'px';\n    pi.style.marginLeft = pp + 'px';\n  }\n\n  if (castPlayer.isLiveContent) {\n    seekTime += castPlayer.mediaInfo.metadata.sectionStartTimeInMedia;\n  }\n\n  castPlayer.playerHandler.seekTo(seekTime);\n};\n\n/**\n * Set current player volume\n * @param {Event} mouseEvent\n */\nCastPlayer.prototype.setVolume = function (mouseEvent) {\n  var p = document.getElementById('audio_bg_level');\n  var pos = 0;\n  if (mouseEvent.currentTarget.id === 'audio_bg_track') {\n    pos = FULL_VOLUME_HEIGHT - parseInt(mouseEvent.offsetY, 10);\n  } else {\n    pos = parseInt(p.clientHeight, 10) - parseInt(mouseEvent.offsetY, 10);\n  }\n  castPlayer.playerHandler.setVolume(pos);\n};\n\n/**\n * Starts the timer to increment the media progress bar\n */\nCastPlayer.prototype.startProgressTimer = function () {\n  castPlayer.stopProgressTimer();\n\n  // Start progress timer\n  castPlayer.timer = setInterval(castPlayer.incrementMediaTimeHandler, TIMER_STEP);\n};\n\n/**\n * Stops the timer to increment the media progress bar\n */\nCastPlayer.prototype.stopProgressTimer = function () {\n  if (castPlayer.timer) {\n    clearInterval(castPlayer.timer);\n    castPlayer.timer = null;\n  }\n};\n\n/**\n * Increment media current time depending on remote or local playback\n */\nCastPlayer.prototype.incrementMediaTime = () => {\n    // First sync with the current player's time\n    castPlayer.currentMediaTime = castPlayer.playerHandler.getCurrentMediaTime();\n    castPlayer.currentMediaDuration = castPlayer.playerHandler.getMediaDuration();\n\n    if (castPlayer.playerState === PLAYER_STATE.PLAYING) {\n        if (castPlayer.currentMediaTime < castPlayer.currentMediaDuration) {\n          castPlayer.currentMediaTime += 1;\n          castPlayer.updateProgressBarByTimer();\n        } else {\n          castPlayer.endPlayback();\n        }\n    }\n};\n\n/**\n * Update progress bar and currentTime based on timer\n */\nCastPlayer.prototype.updateProgressBarByTimer = function () {\n  var p = document.getElementById('progress');\n  if (isNaN(parseInt(p.style.width, 10))) {\n      p.style.width = 0;\n  }\n  if (castPlayer.currentMediaDuration > 0) {\n      var pp = Math.floor(\n          PROGRESS_BAR_WIDTH * castPlayer.currentMediaTime / castPlayer.currentMediaDuration);\n  }\n\n  p.style.width = pp + 'px';\n  var pi = document.getElementById('progress_indicator');\n  pi.style.marginLeft = -21 - PROGRESS_BAR_WIDTH + pp + 'px';\n\n  if (pp >= PROGRESS_BAR_WIDTH) {\n    castPlayer.endPlayback();\n  }\n};\n\n/**\n *  End playback. Called when media ends.\n */\nCastPlayer.prototype.endPlayback = function () {\n  castPlayer.currentMediaTime = 0;\n  castPlayer.stopProgressTimer();\n  castPlayer.playerState = PLAYER_STATE.IDLE;\n  castPlayer.playerHandler.updateDisplay();\n\n  let play = document.getElementById('play');\n  if (play && play.style && play.display)\n    play.style.display = 'block';\n\n  let pause = document.getElementById('pause');\n  if (pause && pause.style && pause.style.display)\n    pause.style.display = 'none';\n};\n\n/**\n * @param {?number} timestamp Linux timestamp\n * @return {?string} media time string. Null if time is invalid.\n */\nCastPlayer.prototype.getMediaTimeString = function (timestamp) {\n  if (timestamp == undefined || timestamp == null) {\n    return null;\n  }\n\n  let isNegative = false;\n  if (timestamp < 0) {\n    isNegative = true;\n    timestamp *= -1;\n  }\n\n  let hours = Math.floor(timestamp / 3600);\n  let minutes = Math.floor((timestamp - (hours * 3600)) / 60);\n  let seconds = Math.floor(timestamp - (hours * 3600) - (minutes * 60));\n\n  if (hours < 10) hours = '0' + hours;\n  if (minutes < 10) minutes = '0' + minutes;\n  if (seconds < 10) seconds = '0' + seconds;\n\n  return (isNegative ? '-' : '') + hours + ':' + minutes + ':' + seconds;\n};\n\n/**\n * @param {number} timestamp Linux timestamp\n * @return {?string} ClockTime string. Null if time is invalid.\n */\nCastPlayer.prototype.getClockTimeString = function (timestamp) {\n  if (!timestamp) return \"0:00:00\";\n\n  let date = new Date(timestamp * 1000);\n  let hours = date.getHours();\n  let minutes = date.getMinutes();\n  let seconds = date.getSeconds();\n  let ampm = hours >= 12 ? 'PM' : 'AM';\n  hours = hours % 12;\n  // Hour '0' should be '12'\n  hours = hours ? hours : 12;\n  minutes = ('0' + minutes).slice(-2);\n  seconds = ('0' + seconds).slice(-2);\n  let clockTime = hours + ':' + minutes + ':' + seconds + ' ' + ampm;\n  return clockTime;\n};\n\n/**\n * Updates Ad markers in UI\n */\nCastPlayer.prototype.updateAdMarkers = function () {\n  let castSession = cast.framework.CastContext.getInstance().getCurrentSession();\n  if (!castSession) return;\n\n  let media = castSession.getMediaSession();\n  if (!media) return;\n\n  let mediaInfo = media.media;\n  if (!mediaInfo) return;\n\n  let breaks = mediaInfo.breaks;\n  let contentDuration = mediaInfo.duration;\n\n  if (!breaks) {\n    return;\n  }\n\n  for (var i = 0; i < breaks.length; i++) {\n    let adBreak = breaks[i];\n\n    // Server-side stitched Ads (embedded) are skipped when the position is beyond\n    // the duration, so they shouldn't be shown with an ad marker on the UI.\n    if (adBreak.position > contentDuration && adBreak.isEmbedded) {\n      continue;\n    }\n\n    // Place marker if not already set in position\n    if (!document.getElementById('ad' + adBreak.position)) {\n      var div = document.getElementById('progress')\n      div.innerHTML += '<div class=\"adMarker\" id=\"ad' + adBreak.position +\n        '\" style=\"margin-left: ' +\n        castPlayer.adPositionToMargin(adBreak.position, contentDuration) + 'px\"></div>';\n    }\n  }\n};\n\n/**\n * Remove Ad markers in UI\n */\nCastPlayer.prototype.removeAdMarkers = function () {\n  document.querySelectorAll('.adMarker').forEach(function (adMarker) {\n    adMarker.remove();\n  });\n};\n\n/**\n * Position of the ad marker from the margin\n */\nCastPlayer.prototype.adPositionToMargin = function (position, contentDuration) {\n  // Post-roll\n  if (position == -1) {\n    return PROGRESS_BAR_WIDTH;\n  }\n\n  // Client stitched Ads (not embedded) beyond the duration, will play at the\n  // end of the content.\n  if (position > contentDuration) {\n    return PROGRESS_BAR_WIDTH;\n  }\n\n  // Convert Ad position to margin\n  return (PROGRESS_BAR_WIDTH * position) / contentDuration;\n};\n\n/**\n * Handle BREAK_CLIP_ID_CHANGED event\n */\nCastPlayer.prototype.onBreakClipIdChanged = function () {\n  // Hide skip button when switching to a new breakClip\n  let skip = document.getElementById('skip');\n  if (skip && skip.style && skip.style.display)\n    skip.style.display = 'none';\n};\n\n/**\n * Disable progress bar if playing a break.\n */\nCastPlayer.prototype.isPlayingBreak = function (isPlayingBreak) {\n  castPlayer.enableProgressBar(!isPlayingBreak);\n};\n\n/**\n * Handle WHEN_SKIPPABLE_CHANGED event\n */\nCastPlayer.prototype.onWhenSkippableChanged = function (whenSkippable) {\n  castPlayer.whenSkippable = whenSkippable;\n};\n\n/**\n * Handle CURRENT_BREAK_CLIP_TIME_CHANGED event\n */\nCastPlayer.prototype.onCurrentBreakClipTimeChanged = function (currentBreakClipTime) {\n  let skip = document.getElementById('skip');\n\n  // Unskippable\n  if (castPlayer.whenSkippable == undefined || castPlayer.whenSkippable < 0) {\n    // Hide skip button    \n    if (skip && skip.style && skip.style.display)\n      skip.style.display = 'none';\n  }\n  // Skippable\n  else if (castPlayer.whenSkippable !== undefined || currentBreakClipTime >= castPlayer.whenSkippable) {\n    // Show skip button    \n    if (skip && skip.style && skip.style.display)\n      skip.style.display = 'block';\n  }\n  // Not ready to be skipped\n  else {\n    // Hide skip button\n    if (skip && skip.style && skip.style.display)\n      skip.style.display = 'none';\n  }\n};\n\n/**\n * Skip the current Ad\n */\nCastPlayer.prototype.skipAd = function () {\n  castPlayer.remotePlayerController.skipAd();\n}\n\n/**\n * Enable/disable progress bar\n */\nCastPlayer.prototype.enableProgressBar = function (enable) {\n  let progress = document.getElementById('progress');\n  let progress_indicator = document.getElementById('progress_indicator');\n  let seekable_window = document.getElementById('seekable_window');\n\n  if (enable) {\n    // Enable UI\n    progress.style.backgroundImage = \"url('./assets/imagefiles/timeline_bg_progress.png')\";\n    progress.style.cursor = \"pointer\";\n    seekable_window.style.cursor = \"pointer\";\n    progress_indicator.style.cursor = \"pointer\";\n    progress_indicator.draggable = true;\n\n    // Add listeners\n    progress.addEventListener('click', castPlayer.seekMediaListener);\n    seekable_window.addEventListener('click', castPlayer.seekMediaListener);\n    progress_indicator.addEventListener('dragend', castPlayer.seekMediaListener);\n  } else {\n    // Disable UI\n    progress.style.backgroundImage = \"url('./assets/imagefiles/timeline_bg_buffer.png')\";\n    progress.style.cursor = \"default\";\n    seekable_window.style.cursor = \"default\";\n    progress_indicator.style.cursor = \"default\";\n    progress_indicator.draggable = false;\n\n    // Remove listeners\n    progress.removeEventListener('click', castPlayer.seekMediaListener);\n    seekable_window.removeEventListener('click', castPlayer.seekMediaListener);\n    progress_indicator.removeEventListener('dragend', castPlayer.seekMediaListener);\n  }\n}\n\n/**\n * Updates media duration text in UI\n */\nCastPlayer.prototype.updateMediaDuration = function() {\n  document.getElementById('duration').innerHTML =\n      CastPlayer.getDurationString(castPlayer.currentMediaDuration);\n};\n\n/**\n * @param {number} durationInSec\n * @return {string}\n */\nCastPlayer.getDurationString = function(durationInSec) {\n  var durationString = '' + Math.floor(durationInSec % 60);\n  var durationInMin = Math.floor(durationInSec / 60);\n  if (durationInMin === 0) {\n      return durationString;\n  }\n  durationString = (durationInMin % 60) + ':' + durationString;\n  var durationInHour = Math.floor(durationInMin / 60);\n  if (durationInHour === 0) {\n      return durationString;\n  }\n  return durationInHour + ':' + durationString;\n};\n\n/**\n * Request full screen mode\n */\nCastPlayer.prototype.requestFullScreen = function () {\n  // Supports most browsers and their versions\n  var element = document.getElementById('video_element');\n  var requestMethod =\n    element['requestFullScreen'] || element['webkitRequestFullScreen'];\n\n  if (requestMethod) {\n    // Native full screen.\n    requestMethod.call(element);\n    console.log('Requested fullscreen');\n  }\n};\n\n/**\n * Exit full screen mode\n */\nCastPlayer.prototype.cancelFullScreen = function () {\n  // Supports most browsers and their versions.\n  var requestMethod =\n    document['cancelFullScreen'] || document['webkitCancelFullScreen'];\n\n  if (requestMethod) {\n    requestMethod.call(document);\n  }\n};\n\n/**\n * Exit fullscreen mode by escape\n */\nCastPlayer.prototype.fullscreenChangeHandler = function () {\n  castPlayer.fullscreen = !castPlayer.fullscreen;\n};\n\n/**\n * Show expand/collapse fullscreen button\n */\nCastPlayer.prototype.showFullscreenButton = function () {\n  let fullscreen_expand = document.getElementById('fullscreen_expand');\n  let fullscreen_collapse = document.getElementById('fullscreen_collapse');\n\n  if (castPlayer.fullscreen) {\n    if (fullscreen_expand && fullscreen_expand.style && fullscreen_expand.style.display)\n      fullscreen_expand.style.display = 'none';\n\n    if (fullscreen_collapse && fullscreen_collapse.style && fullscreen_collapse.style.display)\n      fullscreen_collapse.style.display = 'block';\n  } else {\n    if (fullscreen_expand && fullscreen_expand.style && fullscreen_expand.style.display)\n      fullscreen_expand.style.display = 'block';\n\n    if (fullscreen_collapse && fullscreen_collapse.style && fullscreen_collapse.style.display)\n      fullscreen_collapse.style.display = 'none';\n  }\n};\n\n/**\n * Hide expand/collapse fullscreen button\n */\nCastPlayer.prototype.hideFullscreenButton = function () {\n  let fullscreen_expand = document.getElementById('fullscreen_expand');\n  let fullscreen_collapse = document.getElementById('fullscreen_collapse');\n\n  if (fullscreen_expand && fullscreen_expand.style && fullscreen_expand.style.display)\n    fullscreen_expand.style.display = 'none';\n\n  if (fullscreen_collapse && fullscreen_collapse.style && fullscreen_collapse.style.display)\n    fullscreen_collapse.style.display = 'none';\n};\n\n/**\n * Show the media control\n */\nCastPlayer.prototype.showMediaControl = function () {\n  let media_control = document.getElementById('media_control');\n  if (media_control && media_control.style && media_control.style.opacity)\n    media_control.style.opacity = 0.7;\n};\n\n/**\n * Hide the media control\n */\nCastPlayer.prototype.hideMediaControl = function () {\n  if (typeof cast !== 'undefined') {\n    let context = cast.framework.CastContext.getInstance();\n    if (context && context.getCurrentSession()) {\n      // Do not hide controls during an active cast session.\n      document.getElementById('media_control').style.opacity = 0.7;\n    } else {\n      document.getElementById('media_control').style.opacity = 0;\n    }\n  }\n};\n\n/**\n * Show the volume slider\n */\nCastPlayer.prototype.showVolumeSlider = function () {\n  if (!castPlayer.playerHandler.isMuted()) {\n    document.getElementById('audio_bg').style.opacity = 1;\n    document.getElementById('audio_bg_track').style.opacity = 1;\n    document.getElementById('audio_bg_level').style.opacity = 1;\n    document.getElementById('audio_indicator').style.opacity = 1;\n  }\n};\n\n/**\n * Hide the volume slider\n */\nCastPlayer.prototype.hideVolumeSlider = function () {\n  document.getElementById('audio_bg').style.opacity = 0;\n  document.getElementById('audio_bg_track').style.opacity = 0;\n  document.getElementById('audio_bg_level').style.opacity = 0;\n  document.getElementById('audio_indicator').style.opacity = 0;\n};\n\n/**\n * Reset the volume slider\n */\nCastPlayer.prototype.resetVolumeSlider = function () {\n  var volumeTrackHeight = document.getElementById('audio_bg_track').clientHeight;\n  var defaultVolumeSliderHeight = DEFAULT_VOLUME * volumeTrackHeight;\n  document.getElementById('audio_bg_level').style.height =\n    defaultVolumeSliderHeight + 'px';\n  document.getElementById('audio_on').style.display = 'block';\n  document.getElementById('audio_off').style.display = 'none';\n};\n\n/**\n * Initialize UI components and add event listeners\n */\nCastPlayer.prototype.initializeUI = () => {\n  // Set initial values for title, subtitle, and description\n  document.getElementById('media_title').innerHTML =\n    castPlayer.mediaContents[0]['title'];\n  document.getElementById('media_subtitle').innerHTML =\n    castPlayer.mediaContents[castPlayer.currentMediaIndex]['subtitle'];\n  document.getElementById('media_desc').innerHTML =\n    castPlayer.mediaContents[castPlayer.currentMediaIndex]['description'];\n\n  // Add event handlers to UI components\n  document.getElementById('progress_bg').addEventListener(\n    'click', castPlayer.seekMedia.bind(castPlayer));\n  document.getElementById('progress').addEventListener(\n    'click', castPlayer.seekMedia.bind(castPlayer));\n  document.getElementById('progress_indicator').addEventListener(\n    'dragend', castPlayer.seekMedia.bind(castPlayer));\n  document.getElementById('audio_on').addEventListener(\n    'click', castPlayer.playerHandler.mute.bind(castPlayer.playerHandler));\n  document.getElementById('audio_off').addEventListener(\n    'click', castPlayer.playerHandler.unMute.bind(castPlayer.playerHandler));\n  document.getElementById('audio_bg').addEventListener(\n    'mouseover', castPlayer.showVolumeSlider.bind(castPlayer));\n  document.getElementById('audio_on').addEventListener(\n    'mouseover', castPlayer.showVolumeSlider.bind(castPlayer));\n  document.getElementById('audio_bg_level').addEventListener(\n    'mouseover', castPlayer.showVolumeSlider.bind(castPlayer));\n  document.getElementById('audio_bg_track').addEventListener(\n    'mouseover', castPlayer.showVolumeSlider.bind(castPlayer));\n  document.getElementById('audio_bg_level').addEventListener(\n    'click', castPlayer.setVolume.bind(castPlayer));\n  document.getElementById('audio_bg_track').addEventListener(\n    'click', castPlayer.setVolume.bind(castPlayer));\n  document.getElementById('audio_bg').addEventListener(\n    'mouseout', castPlayer.hideVolumeSlider.bind(castPlayer));\n  document.getElementById('audio_on').addEventListener(\n    'mouseout', castPlayer.hideVolumeSlider.bind(castPlayer));\n  document.getElementById('main_video').addEventListener(\n    'mouseover', castPlayer.showMediaControl.bind(castPlayer));\n  document.getElementById('main_video').addEventListener(\n    'mouseout', castPlayer.hideMediaControl.bind(castPlayer));\n  document.getElementById('media_control').addEventListener(\n    'mouseover', castPlayer.showMediaControl.bind(castPlayer));\n  document.getElementById('media_control').addEventListener(\n    'mouseout', castPlayer.hideMediaControl.bind(castPlayer));\n  document.getElementById('fullscreen_expand').addEventListener(\n    'click', castPlayer.requestFullScreen.bind(castPlayer));\n  document.getElementById('fullscreen_collapse').addEventListener(\n    'click', castPlayer.cancelFullScreen.bind(castPlayer));\n  document.addEventListener(\n    'fullscreenchange', castPlayer.fullscreenChangeHandler.bind(castPlayer), false);\n  document.addEventListener(\n    'webkitfullscreenchange', castPlayer.fullscreenChangeHandler.bind(castPlayer), false);\n\n  // Enable play/pause buttons\n  document.getElementById('play').addEventListener(\n    'click', castPlayer.playerHandler.play.bind(castPlayer.playerHandler));\n  document.getElementById('pause').addEventListener(\n    'click', castPlayer.playerHandler.pause.bind(castPlayer.playerHandler));\n  document.getElementById('progress_indicator').draggable = true;\n};\n\n/**\n * Add video thumbnails div's to UI for media JSON contents\n */\nCastPlayer.prototype.addVideoThumbs = function () {\n  if (typeof castPlayer.mediaJSON !== 'undefined' && castPlayer.mediaJSON['categories'] && castPlayer.mediaJSON['categories'].length > 0) {\n    castPlayer.mediaContents = castPlayer.mediaJSON['categories'][0]['videos'];\n    var ni = document.getElementById('carousel');\n    var newdiv = null;\n    var divIdName = null;\n    for (var i = 0; i < castPlayer.mediaContents.length; i++) {\n      newdiv = document.createElement('div');\n      divIdName = 'thumb' + i + 'Div';\n      newdiv.setAttribute('id', divIdName);\n      newdiv.setAttribute('class', 'thumb');\n      newdiv.innerHTML =\n        '<img src=\"' + MEDIA_SOURCE_ROOT + castPlayer.mediaContents[i]['thumb'] +\n        '\" class=\"thumbnail\">';\n      newdiv.addEventListener('click', castPlayer.selectMedia.bind(castPlayer, i));\n      ni.appendChild(newdiv);\n    }\n  }\n};\n\nCastPlayer.prototype.addMediaContents = () => {\n  if (typeof castPlayer.mediaJSON !== 'undefined' && castPlayer.mediaJSON['categories'] && castPlayer.mediaJSON['categories'].length > 0) {\n    castPlayer.mediaContents = castPlayer.mediaJSON['categories'][0]['videos'];\n    return castPlayer.mediaContents;\n  } else {\n    return null;\n  }\n};\n\n/**\n * Makes human-readable message from chrome.cast.Error\n * @param {chrome.cast.Error} error\n * @return {string} error message\n */\nCastPlayer.getErrorMessage = function (error) {\n  switch (error.code) {\n    case chrome.cast.ErrorCode.API_NOT_INITIALIZED:\n      return 'The API is not initialized.' +\n        (error.description ? ' :' + error.description : '');\n    case chrome.cast.ErrorCode.CANCEL:\n      return 'The operation was canceled by the user' +\n        (error.description ? ' :' + error.description : '');\n    case chrome.cast.ErrorCode.CHANNEL_ERROR:\n      return 'A channel to the receiver is not available.' +\n        (error.description ? ' :' + error.description : '');\n    case chrome.cast.ErrorCode.EXTENSION_MISSING:\n      return 'The Cast extension is not available.' +\n        (error.description ? ' :' + error.description : '');\n    case chrome.cast.ErrorCode.INVALID_PARAMETER:\n      return 'The parameters to the operation were not valid.' +\n        (error.description ? ' :' + error.description : '');\n    case chrome.cast.ErrorCode.RECEIVER_UNAVAILABLE:\n      return 'No receiver was compatible with the session request.' +\n        (error.description ? ' :' + error.description : '');\n    case chrome.cast.ErrorCode.SESSION_ERROR:\n      return 'A session could not be created, or a session was invalid.' +\n        (error.description ? ' :' + error.description : '');\n    case chrome.cast.ErrorCode.TIMEOUT:\n      return 'The operation timed out.' +\n        (error.description ? ' :' + error.description : '');\n    default:\n      return error;\n  }\n};\n\nvar castPlayer = new CastPlayer();\nwindow['__onGCastApiAvailable'] = function (isAvailable) {\n  if (isAvailable) {\n    castPlayer.initializeCastPlayer();\n  }\n};\n\nwindow.CastPlayer = castPlayer;\n"]}