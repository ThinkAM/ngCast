{"version":3,"file":"thinkam.net-ng-cast.js","sources":["../../ng-cast.component.ts","../../shared/ng-cast.service.ts","../../ng.cast.module.ts","../../thinkam.net-ng-cast.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\n\nimport { NgCastService } from './shared/ng-cast.service';\n\n@Component({\n  selector: 'ng-cast',\n  templateUrl: './ng-cast.component.html',\n  styleUrls: [\n    './ng-cast.component.scss'\n  ]\n})\nexport class NgCastComponent implements OnInit {\n  castingStatus: any;\n  constructor(\n    private ngCastService: NgCastService\n  ) { }\n\n  private window: any = window;\n\n  ngOnInit() {\n\n    let script = window['document'].createElement('script');\n    script.setAttribute('type', 'text/javascript');\n    script.setAttribute('src', 'https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1');\n    window['document'].body.appendChild(script);\n\n    let ngCastService = this.ngCastService;\n    this.window['__onGCastApiAvailable'] = function (isAvailable: any) {\n      if (isAvailable) {\n        ngCastService.initializeCastApi();\n      }\n    };\n\n    this.castingStatus = this.ngCastService.getStatus();\n  }\n\n  openSession() {\n    this.ngCastService.discoverDevices();\n  }\n\n  closeSession() {\n    this.ngCastService.stop();\n  }\n\n}\n","import { Injectable } from '@angular/core';\n\nimport { Subject } from 'rxjs';\n\nlet cast: any;\nlet chrome: any;\n\n@Injectable()\nexport class NgCastService {\n  private cast: any;\n  private session: any;\n  private currentMedia: any;\n  private window: any = window;\n  public status = {\n    casting: false\n  };\n\n  constructor() {}\n\n  initializeCastApi() {\n    this.cast = this.window['chrome'].cast;\n    let sessionRequest = new this.cast.SessionRequest(this.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID);\n    let apiConfig = new this.cast.ApiConfig(sessionRequest,\n      () => { },\n      (status: any) => { if (status === this.cast.ReceiverAvailability.AVAILABLE) { } }\n    );\n    let x = this.cast.initialize(apiConfig, this.onInitSuccess, this.onError);\n  };\n\n  onGCastApiAvailable(url: string, type: string): void {\n    this.window.__onGCastApiAvailable = (isAvailable: boolean) => {\n      if(!isAvailable){\n          return false;\n      }\n  \n      var castContext = cast.framework.CastContext.getInstance();\n  \n      castContext.setOptions({\n          autoJoinPolicy: chrome.cast.AutoJoinPolicy.ORIGIN_SCOPED,\n          receiverApplicationId: chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID\n      });\n  \n      var stateChanged = cast.framework.CastContextEventType.CAST_STATE_CHANGED;\n      castContext.addEventListener(stateChanged, () => {\n          var castSession = castContext.getCurrentSession();\n          var media = new chrome.cast.media.MediaInfo(url, type);\n          var request = new chrome.cast.media.LoadRequest(media);\n  \n          castSession && castSession\n              .loadMedia(request)\n              .then(() => {\n                  console.log('Success');\n              })\n              .catch((error: any) => {\n                  console.log('Error: ' + error);\n              });\n      });\n    };\n  }\n\n  onInitSuccess = function () {\n    console.log('GCast initialization success');\n  };\n\n  onError = function (err: any) {\n    console.log('GCast initialization failed', err);\n  };\n\n  discoverDevices = () => {\n    let self: any = this;\n    let subj = new Subject();\n    this.cast.requestSession((s: any) => {\n      self.session = s;\n      self.setCasting(true);\n      subj.next('CONNECTED');\n    }, function (err: any) {\n      self.setCasting(false);\n      if (err.code === 'cancel') {\n        self.session = undefined;\n        subj.next('CANCEL');\n      } else {\n        console.error('Error selecting a cast device', err);\n      }\n    });\n    return subj;\n  };\n\n  launchMedia = (media: any) =>  {\n    let mediaInfo = new this.cast.media.MediaInfo(media);\n    let request = new this.cast.media.LoadRequest(mediaInfo);\n    console.log('launch media with session', this.session);\n\n    if (!this.session) {\n      window.open(media);\n      return false;\n    }\n    this.session.loadMedia(request, this.onMediaDiscovered.bind(this, 'loadMedia'), this.onMediaError);\n    return true;\n  };\n\n  onMediaDiscovered = (media: any) => {\n    this.currentMedia = media;\n  };\n\n  play = () => {\n    this.currentMedia.play(null);\n  };\n\n  pause = () => {\n    this.currentMedia.pause(null);\n  };\n\n  stop = () => {\n    this.currentMedia.stop(null);\n  };\n\n  onMediaError = (err: any) => {\n    console.error('Error launching media', err);\n  };\n\n  setCasting(value: any) {\n    this.status.casting = value;\n  }\n\n  getStatus() {\n    return this.status\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { NgCastComponent } from './ng-cast.component';\nimport { NgCastService } from './shared/ng-cast.service';\n\n@NgModule({\n  imports: [\n    CommonModule\n  ],\n  exports: [NgCastComponent],\n  providers: [NgCastService],\n  declarations: [NgCastComponent]\n})\nexport class NgCastModule { }\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n\nexport {NgCastComponent as Éµa} from './ng-cast.component';"],"names":[],"mappings":"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"}