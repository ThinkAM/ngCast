{"version":3,"file":"thinkam.net-ng-cast.js","sources":["../../ng-cast.component.ts","../../shared/ng-cast.service.ts","../../ng.cast.module.ts","../../thinkam.net-ng-cast.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\n\nimport { NgCastService } from './shared/ng-cast.service';\n\n@Component({\n  selector: 'ng-cast',\n  templateUrl: './ng-cast.component.html',\n  styleUrls: [\n    './ng-cast.component.scss'\n  ]\n})\nexport class NgCastComponent implements OnInit {\n  castingStatus: any;\n  constructor(\n    private ngCastService: NgCastService\n  ) { }\n\n  ngOnInit() {\n\n    let script = window['document'].createElement('script');\n    script.setAttribute('type', 'text/javascript');\n    script.setAttribute('src', 'https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1');\n    window['document'].body.appendChild(script);\n\n    let ngCastService = this.ngCastService;\n    window['__onGCastApiAvailable'] = function (isAvailable: any) {\n      if (isAvailable) {\n        ngCastService.initializeCastApi();\n      }\n    };\n\n    this.castingStatus = this.ngCastService.getStatus();\n  }\n\n  openSession() {\n    this.ngCastService.discoverDevices();\n  }\n\n  closeSession() {\n    this.ngCastService.stop();\n  }\n\n}\n","import { Injectable } from '@angular/core';\n\nimport { Subject } from 'rxjs';\n\n@Injectable()\nexport class NgCastService {\n  private castSession;\n  private cast;\n  public status = {\n    casting: false\n  };\n\n  constructor() {}\n\n  initializeCastApi() {\n    this.cast = window['chrome'].cast;\n    let sessionRequest = new this.cast.SessionRequest(this.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID);\n    let apiConfig = new this.cast.ApiConfig(sessionRequest,\n      s => { },\n      status => { if (status === this.cast.ReceiverAvailability.AVAILABLE) { } }\n    );\n    let x = this.cast.initialize(apiConfig, this.onInitSuccess, this.onError);\n  };\n\n  onInitSuccess = function (e) {\n    console.log('GCast initialization success');\n  };\n\n  onError = function (err) {\n    console.log('GCast initialization failed', err);\n  };\n\n  discoverDevices = function () {\n    let self = this;\n    let subj = new Subject();\n    this.cast.requestSession(function (s) {\n      self.session = s;\n      self.setCasting(true);\n      subj.next('CONNECTED');\n    }, function (err) {\n      self.setCasting(false);\n      if (err.code === 'cancel') {\n        self.session = undefined;\n        subj.next('CANCEL');\n      } else {\n        console.error('Error selecting a cast device', err);\n      }\n    });\n    return subj;\n  };\n\n  launchMedia = function (media) {\n    let mediaInfo = new this.cast.media.MediaInfo(media);\n    let request = new this.cast.media.LoadRequest(mediaInfo);\n    console.log('launch media with session', this.session);\n\n    if (!this.session) {\n      window.open(media);\n      return false;\n    }\n    this.session.loadMedia(request, this.onMediaDiscovered.bind(this, 'loadMedia'), this.onMediaError);\n    return true;\n  };\n\n  onMediaDiscovered = function (how, media) {\n    this.currentMedia = media;\n  };\n\n  play = function () {\n    this.currentMedia.play(null);\n  };\n\n  pause = function () {\n    this.currentMedia.pause(null);\n  };\n\n  stop = function () {\n    this.currentMedia.stop(null);\n  };\n\n  onMediaError = function (err) {\n    console.error('Error launching media', err);\n  };\n\n  setCasting(value) {\n    this.status.casting = value;\n  }\n\n  getStatus() {\n    return this.status\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { NgCastComponent } from './ng-cast.component';\nimport { NgCastService } from './shared/ng-cast.service';\n\n@NgModule({\n  imports: [\n    CommonModule\n  ],\n  exports: [NgCastComponent],\n  providers: [NgCastService],\n  declarations: [NgCastComponent]\n})\nexport class NgCastModule { }\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n\nexport {NgCastComponent as Éµa} from './ng-cast.component';"],"names":[],"mappings":"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"}